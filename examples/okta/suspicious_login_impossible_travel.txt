# Okta Detection Rule: Suspicious Login from Impossible Travel
#
# Description: Detects when a user logs in from two geographically distant
# locations within an impossibly short time frame (impossible travel).
#
# Data Source: Okta authentication logs
# Severity: High
# MITRE ATT&CK: T1078 - Valid Accounts

Detect when:
  - Event type is "user.session.start"
  - Login outcome is SUCCESS
  - Security context flag "is_suspicious" is true
  - Security context includes "IMPOSSIBLE_TRAVEL" as anomaly type

Alert should:
  - Generate high severity alert
  - Tag the user session as suspicious
  - Include user email, source IP, and location details in the alert
