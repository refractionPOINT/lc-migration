name: Okta Brute Force Attack Detection
description: Detects multiple failed login attempts from the same source IP within a short time period
severity: medium
platform: okta

detection_logic: |
  Monitor Okta authentication events for failed login attempts.

  Conditions:
  - Event type: user.session.start
  - Outcome: FAILURE
  - Count: More than 5 failures from same source IP within 5 minutes

  Excludes:
  - Known automated testing IPs
  - Service accounts

response_actions:
  - Generate alert with details:
    - Source IP address
    - Target username
    - Number of attempts
    - Time window
  - Tag the source IP as potentially malicious
  - Consider blocking the IP if attempts exceed 10

mitre_attack:
  - T1110.001  # Brute Force: Password Guessing
  - T1078      # Valid Accounts
